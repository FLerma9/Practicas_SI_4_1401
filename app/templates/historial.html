{% extends "base.html" %}

{% block title %}
    {{ title }}
{% endblock%}

{% block content %}
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script>
    $(document).ready(function(){
      $(".pedido").click(function(){
        $("#div" + $(this).attr('id')).toggle();
      });
    });
  </script>
  <div class="historial">
    <h3> Saldo total: € </h3>
    <form action="/historial" method="post" class="historial-form">
      <label for="saldo"><b>Add cash €: </b></label>
      <input name="saldo" type="number" placeholder="Enter amount in euros" min="0" step="any">
      <input type="submit" value="Add cash to account"><br><br>
    </form>
    {% for pedido in historial %}
    <button class="pedido" id="{{ pedido.numero_pedido }}"> Pedido número {{ pedido.numero_pedido }}.</button>
    <div class="detalles" id="div{{ pedido.numero_pedido }}">
      <ul>
        <li> Número del pedido: {{ pedido.numero_pedido }}</li>
        <li> Fecha del pedido: {{ pedido.fecha_pedido }}</li>
        <li> Películas compradas:
          <table>
            <tr>
              <th>Id</th>
              <th>Titulo</th>
              <th>Precio</th>
            </tr>
            {% for pelicula in pedido.peliculas %}
            <tr>
              <td>{{ pelicula.id }}</td>
              <td>{{ pelicula.titulo }}</td>
              <td>{{ pelicula.precio }}€</td>
            </tr>
            {% endfor %}
          </table>
        <li> Precio total del pedido: {{ pedido.precio_total }}€.</li>
      </ul>
    </div>
    {% endfor %}
  </div>
{% endblock %}
